<link rel="import" href="../polymer/polymer-element.html">

<link rel="import" href="../app-layout/app-layout.html">
<link rel="import" href="../app-layout/app-toolbar/app-toolbar.html">

<link rel="import" href="../paper-icon-button/paper-icon-button.html">
<link rel="import" href="../iron-icons/iron-icons.html">

<link rel="import" href="dory-sam-editor-control.html">

<dom-module id="dory-editor-layout">
    <template>
        <style>
            :host {
                display: block;
            }
            .logo{
                padding: 10px;
                text-align: center;
                background-color: var(--logo-background-color);
            }
            app-drawer {
                --app-drawer-content-container: {
                    background-color: var(--sidebar-background-color);
                }
            }
            app-toolbar {
                height:122px;
            }
            .content{
                background-color: var(--background-color);
                width : 100%;
                position : absolute;
            }
            .control{
                position:fixed;
                right:15px;
            }
            app-drawer-layout:not([narrow]) [drawer-toggle] {
                display: none;
            }
        </style>

        <app-drawer-layout>
            <app-drawer opened slot="drawer" class="sidebar">
                <div class="logo">
                    <img src="[[logo]]" alt="Agrica">
                </div>
                <div class="sidebar">
                    <slot name="sidebar"></slot>
                </div>
            </app-drawer>

            <app-header-layout>
                <app-header reveals fixed>
                    <app-toolbar>
                        <paper-icon-button drawer-toggle icon="menu"></paper-icon-button>
                        <paper-icon-button on-tap="_back" icon="arrow-back"></paper-icon-button>
                        <h2><slot name="title"></slot></h2>
                        <div class="control">
                            <dory-sam-editor-control id="controller"></dory-sam-editor-control>
                        </div>
                    </app-toolbar>
                </app-header>
            </app-header-layout>
            <div class="content">
                <slot name="editor"></slot>
            </div>
        </app-drawer-layout>
    </template>

    <script>
        /**
         * `dory-editor-layout`
         *
         *
         * @customElement
         * @polymer
         * @demo demo/index.html
         */
        class DoryEditorLayout extends Polymer.Element {
            static get is() {
                return 'dory-editor-layout';
            }

            static get properties() {
                return {
                    logo : {
                        type : String
                    }
                };
            }

            ready(){
                super.ready();
                this.$.controller.addEventListener('dory-control-editor', e => this._handleController(e));
            }

            _back() {
                this.dispatchEvent(new CustomEvent('editor-close'));
            }
            _handleController(e){
                this.dispatchEvent(new CustomEvent('editor-control',{detail:{command:e.detail.command}}))
            }
        }

        window.customElements.define(DoryEditorLayout.is, DoryEditorLayout);
    </script>
</dom-module>