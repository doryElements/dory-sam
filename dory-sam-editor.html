<link rel="import" href="../polymer/polymer-element.html">



<link rel="import" href="dory-sam-editor-form.html">

<link rel="import" href="../air-cruddy/air-cruddy-elasticsearch.html">
<link rel="import" href="../air-cascade-validator/air-cascade-validator.html">
<link rel="import" href="../app-layout/app-layout.html">
<link rel="import" href="../app-layout/app-toolbar/app-toolbar.html">

<dom-module id="dory-sam-editor">
    <template>
        <style>
            :host {
                display: block;
            }

            .editor-form{
                background-color: var(--dory-background-color);
            }
            app-header{
                position:fixed;
            }
        </style>
        <air-cruddy-elasticsearch id="cruddy"  mode="cors" url="http://localhost:9200/sam/sam"
                                  elastic-refresh="true" debug auto-save
                                  data="{{data}}" entity-id="{{entityId}}">
            <air-cascade-validator>
                <div class="editor-form">
                    <dory-sam-editor-form id="editor-form" data="{{data}}"></dory-sam-editor-form>
                </div>
                <dory-sam-editor-control id="controller"></dory-sam-editor-control>
            </air-cascade-validator>
        </air-cruddy-elasticsearch>
    </template>

    <script>
        /**
         * `dory-sam-editor`
         *
         *
         * @customElement
         * @polymer
         */
        class DorySamEditor extends Polymer.Element {
            static get is() {
                return 'dory-sam-editor';
            }

            ready(){
                super.ready();
                this.$.controller.addEventListener('dory-control-editor', e => this._handleController(e));
            }

            static get properties() {
                return {
                    entityId: {
                        type: String
                    },
                    data: {
                        type: Object,
                        notify: true
                    }
                };
            }

            _handleController(e){
                console.log(e.detail.command);
                this.$.cruddy.command=e.detail.command;
            }
        }
        window.customElements.define(DorySamEditor.is, DorySamEditor);
    </script>
</dom-module>
